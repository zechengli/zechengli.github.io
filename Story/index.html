<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Stories | Zecheng Li</title>
<link rel="stylesheet" href="../style.css" />
</head>
<body>

<nav class="navbar">
    <ul>
        <li><a href="/Home/" id="nav-control-link">Home</a></li>
    </ul>
</nav>


<main class="container">


    <section class="content" id="story-list-view">
        <h2>Stories</h2>
        <ul class="story-list">
            <li>
                <a href="#" 
                   data-story-title="How I Built This Website"
                   data-story-meta="Dec 2025 Â· GitHub Pages"
                   data-file="content/story-1-body.html">
                    <h3>ğŸ“Œ How I Built This Website</h3>
                    <p class="story-meta">Dec 2025 Â· GitHub Pages</p>
                </a>
            </li>
            <li>
                <a href="#" 
                   data-story-title="Applying for a PhD: What I Didnâ€™t Expect"
                   data-story-meta="Dec 2025 Â· PhD Journey"
                   data-file="content/story-2-body.html">
                    <h3>ğŸ“Œ Applying for a PhD: What I Didnâ€™t Expect</h3>
                    <p class="story-meta">Dec 2025 Â· PhD Journey</p>
                </a>
            </li>
        </ul>
    </section>


    <article class="content hidden" id="story-detail-view">
        <h2 id="story-title"></h2>
        <p class="story-meta" id="story-meta"></p>
        <div id="story-content">Loading story...</div> 
    </article>


</main>


<script>
// ===================================
// DOM å…ƒç´ è·å–
// ===================================
const listView = document.getElementById('story-list-view');
const detailView = document.getElementById('story-detail-view');
const storyTitleEl = document.getElementById('story-title');
const storyMetaEl = document.getElementById('story-meta');
const storyContentEl = document.getElementById('story-content');
const storyLinks = document.querySelectorAll('.story-list a');
const navControlLink = document.getElementById('nav-control-link');


// ===================================
// æ ¸å¿ƒé€»è¾‘å‡½æ•°
// ===================================

/**
 * @description æ˜¾ç¤ºæ•…äº‹åˆ—è¡¨è§†å›¾ï¼Œå¹¶æ›´æ–°å¯¼èˆªæ ä¸º Homeã€‚
 */
function showList() {
    // åˆ‡æ¢è§†å›¾
    detailView.classList.add('hidden');
    listView.classList.remove('hidden');

    // æ›´æ–°å¯¼èˆªæ ï¼šè¿”å› Home é¡µé¢
    navControlLink.href = '/Home/'; 
    navControlLink.textContent = 'Home';
    // ç§»é™¤ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨ï¼Œè®©é“¾æ¥æ¢å¤é»˜è®¤çš„è·³è½¬è¡Œä¸º
    navControlLink.removeEventListener('click', handleNavBack); 
}

/**
 * @description å¼‚æ­¥åŠ è½½å¹¶æ˜¾ç¤ºæ•…äº‹è¯¦æƒ…è§†å›¾ï¼Œå¹¶æ›´æ–°å¯¼èˆªæ ä¸º Backã€‚
 * @param {HTMLElement} linkElement - è¢«ç‚¹å‡»çš„æ•…äº‹é“¾æ¥å…ƒç´ ã€‚
 */
async function showStory(linkElement) {
    const title = linkElement.getAttribute('data-story-title');
    const meta = linkElement.getAttribute('data-story-meta');
    const filePath = linkElement.getAttribute('data-file');

    // 1. åˆ‡æ¢è§†å›¾åˆ°è¯¦æƒ…é¡µï¼Œå¹¶æ˜¾ç¤ºåŠ è½½æç¤º
    storyTitleEl.textContent = title;
    storyMetaEl.textContent = meta;
    storyContentEl.innerHTML = 'Loading content...'; 
    listView.classList.add('hidden');
    detailView.classList.remove('hidden');
    
    // æ›´æ–°å¯¼èˆªæ ï¼šæ·»åŠ è¿”å›åˆ—è¡¨çš„é€»è¾‘
    navControlLink.href = '#list'; // å‡é“¾æ¥ï¼Œç”¨äºåŒºåˆ†
    navControlLink.textContent = 'â† Back to Stories';
    // ç¡®ä¿åªæ·»åŠ ä¸€æ¬¡ç›‘å¬å™¨ï¼Œé¿å…é‡å¤è§¦å‘
    navControlLink.removeEventListener('click', handleNavBack); 
    navControlLink.addEventListener('click', handleNavBack); 

    try {
        // 2. å¼‚æ­¥è·å– HTML ç‰‡æ®µæ–‡ä»¶
        const response = await fetch(filePath);
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        const htmlContent = await response.text();
        
        // 3. æ’å…¥å†…å®¹
        storyContentEl.innerHTML = htmlContent;

    } catch (error) {
        console.error('Failed to load story content:', error);
        storyContentEl.innerHTML = 'Oops! Failed to load the story. Please check the file path: ' + filePath;
    }
}

/**
 * @description å¤„ç†å¯¼èˆªæ ç‚¹å‡»äº‹ä»¶ï¼Œç”¨äºä»è¯¦æƒ…é¡µè¿”å›åˆ—è¡¨ã€‚
 * @param {Event} e - ç‚¹å‡»äº‹ä»¶å¯¹è±¡ã€‚
 */
function handleNavBack(e) {
    // ä»…åœ¨å½“å‰é“¾æ¥æ˜¯â€œè¿”å›æ•…äº‹åˆ—è¡¨â€æ—¶é˜»æ­¢é»˜è®¤è¡Œä¸º
    if (navControlLink.href.endsWith('#list')) {
        e.preventDefault(); 
        showList();
    }
}


// ===================================
// é¡µé¢åˆå§‹åŒ–å’Œäº‹ä»¶ç»‘å®š
// ===================================

// 1. ä¸ºåˆ—è¡¨ä¸­çš„æ¯ä¸ªé“¾æ¥æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
storyLinks.forEach(link => {
    link.addEventListener('click', function(event) {
        event.preventDefault(); // é˜»æ­¢é»˜è®¤è·³è½¬
        showStory(this);
    });
});

// 2. åˆå§‹åŠ è½½æ—¶æ˜¾ç¤ºåˆ—è¡¨
showList();

</script>

</body>
</html>
